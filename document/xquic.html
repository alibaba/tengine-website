<!DOCTYPE html><html lang="cn" dir="ltr" class="no-js" data-env="dev-env"><head><meta name="generator" content="Hexo 3.9.0"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-SNH2MHXGCW"></script><script>window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-SNH2MHXGCW');</script><meta charset="utf-8"><meta name="renderer" content="webkit"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="author" content="Designed by 阿里云UED AX"><title>ngx_http_xquic_module - The Tengine Web Server</title><meta name="description" content="Tengine XQUIC Module主要用于在服务端启用QUIC/HTTP3监听服务。配置主要由HTTP main conf和listen配置两部分组成，标注「必选项」为启用QUIC的必选配置项，未标注则为可选配置项（不配则启用默认配置）。配置示例配置文件: conf/nginx.confxquic_log   &amp;quot;pipe:rollback /home/admin/tengine/l"><meta property="og:type" content="article"><meta property="og:title" content="ngx_http_xquic_module"><meta property="og:url" content="http://tengine.taobao.org/document/xquic.html"><meta property="og:site_name" content="The Tengine Web Server"><meta property="og:description" content="Tengine XQUIC Module主要用于在服务端启用QUIC/HTTP3监听服务。配置主要由HTTP main conf和listen配置两部分组成，标注「必选项」为启用QUIC的必选配置项，未标注则为可选配置项（不配则启用默认配置）。配置示例配置文件: conf/nginx.confxquic_log   &amp;quot;pipe:rollback /home/admin/tengine/l"><meta property="og:locale" content="default"><meta property="og:updated_time" content="2023-08-11T08:31:43.981Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="ngx_http_xquic_module"><meta name="twitter:description" content="Tengine XQUIC Module主要用于在服务端启用QUIC/HTTP3监听服务。配置主要由HTTP main conf和listen配置两部分组成，标注「必选项」为启用QUIC的必选配置项，未标注则为可选配置项（不配则启用默认配置）。配置示例配置文件: conf/nginx.confxquic_log   &amp;quot;pipe:rollback /home/admin/tengine/l"><link rel="alternate" href="/atom.xml" title="The Tengine Web Server" type="application/atom+xml"><link rel="stylesheet" href="/css/base.min.css"><link rel="stylesheet" href="/css/main.css"></head><body class="page-is-loading"><div class="container-fluid"><div class="row global-header"><div class="container"><div class="row"><div class="col-lg-12"><div class="row"><div class="navbar-header col-lg-2 col-xs-12"><button aria-controls="nav-menu" aria-expanded="false" class="navbar-toggle collapsed" data-target="#nav-menu" data-toggle="collapse" type="button"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button><h1 class="text-muted site-logo navbar-brand"><a href="/" id="logo" class="text-hide">The Tengine Web Server</a></h1></div><div class="col-lg-10 col-xs-12"><nav id="nav-menu" class="navbar-collapse collapse" aria-expanded="false"><ul class="nav navbar-nav navbar-right"><li role="presentation"><a class="menu-item" href="/documentation.html">Tengine</a></li><li role="presentation"><a class="menu-item" href="/ingress.html">Ingress</a></li><li role="presentation"><a class="menu-item" href="/guide.html">Guide</a></li><li role="presentation"><a class="menu-item" href="/blog.html">Blog</a></li><li role="presentation"><a class="menu-item" href="/download.html">Download</a></li><li role="presentation"><a class="menu-item" href="/source.html">Source</a></li><li role="presentation"><a class="menu-item" href="/contact.html">Contact</a></li><li role="presentation"><a class="menu-item" href="/faq.html">FAQ</a></li><li role="presentation" class="col-hide-xs"><select class="lang-switch pull-right"></select></li><li role="presentation" class="hide"><a href="#"><i class="fa fa-bars" aria-hidden="true"></i></a></li></ul></nav></div></div></div></div></div></div></div><div class="container-fluid" id="main"><section class="row"><div class="fluid-container"><div class="container"><article id="post-document/xquic" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-inner"><header class="article-header"><h1 class="article-title" itemprop="name">ngx_http_xquic_module</h1></header><div class="article-entry" itemprop="articleBody"><p>Tengine XQUIC Module主要用于在服务端启用QUIC/HTTP3监听服务。<br>配置主要由HTTP main conf和listen配置两部分组成，标注「必选项」为启用QUIC的必选配置项，未标注则为可选配置项（不配则启用默认配置）。</p><h2 id="配置示例"><a href="#配置示例" class="headerlink" title="配置示例"></a>配置示例</h2><h2 id="配置文件-conf-nginx-conf"><a href="#配置文件-conf-nginx-conf" class="headerlink" title="配置文件: conf/nginx.conf"></a>配置文件: conf/nginx.conf</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">xquic_log   &quot;pipe:rollback /home/admin/tengine/logs/tengine-xquic.log baknum=10 maxsize=1G interval=1d adjust=600&quot; info;</span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line"></span><br><span class="line">    ## add for xquic ####</span><br><span class="line">    xquic_ssl_certificate        /etc/tengine/ssl/certificate.crt;</span><br><span class="line">    xquic_ssl_certificate_key    /etc/tengine/ssl/certificate.key;</span><br><span class="line">    xquic_ssl_session_ticket_key /etc/tengine/ssl/session_ticket.key;</span><br><span class="line"></span><br><span class="line">    xquic_congestion_control bbr;</span><br><span class="line">    xquic_socket_rcvbuf 5242880;</span><br><span class="line">    xquic_socket_sndbuf 5242880;</span><br><span class="line">    xquic_anti_amplification_limit 5;</span><br><span class="line">    ## end for xquic ####</span><br><span class="line"></span><br><span class="line">    server &#123;</span><br><span class="line">        listen 2443 xquic reuseport;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="指令"><a href="#指令" class="headerlink" title="指令"></a>指令</h2><blockquote><p>(必选项)<br>Syntax: <strong>listen</strong> 2443 <code>reuseport xquic</code>;<br>Default: -<br>Context: <code>server</code></p></blockquote><p>在listen指令中添加xquic选项，表示该端口启用quic/http3监听检查，一般和reuseport搭配使用。<br>该配置项强依赖xquic证书配置项启用tls/1.3握手和证书校验。</p><hr><blockquote><p>(必选项)<br>Syntax: <strong>xquic_ssl_certificate</strong> <code>/certificate/file path</code>;<br>Default: -<br>Context: <code>http</code></p></blockquote><p>从配置的指定目录读取quic(tls/1.3)加密握手需要的证书文件。</p><hr><blockquote><p>(必选项)<br>Syntax: <strong>xquic_ssl_certificate_key</strong> <code>/certificate key/file path</code>;<br>Default: -<br>Context: <code>http</code></p></blockquote><p>从配置的指定目录读取quic(tls/1.3)加密握手需要的证书私钥文件，私钥与证书公钥配套。</p><hr><blockquote><p>Syntax: <strong>xquic_ssl_session_ticket_key</strong> <code>/ticket/file path</code>;<br>Default: -<br>Context: <code>http</code></p></blockquote><p>从配置的指定目录读取quic(tls/1.3)加密session ticket需要的秘钥文件，格式与ssl_session_ticket_key相同，配置后才可以启用session ticket功能。</p><hr><blockquote><p>Syntax: <strong>xquic_log</strong> <code>&quot;pipe:rollback /home/admin/tengine/logs/tengine-xquic.log baknum=10 maxsize=1G interval=1d adjust=600&quot; info</code>;<br>Default: -<br>Context: <code>main</code></p></blockquote><p>向配置的指定目录打印xquic协议栈统计日志，支持滚动日志方式（可与rollback模块联动），可用xquic日志等级控制日志信息，日志等级可选范围为:</p><ul><li>report</li><li>fatal</li><li>error</li><li>warn</li><li>stats</li><li>info</li><li>debug<br>和Tengine日志等级类似，日志等级&gt;=配置等级的日志内容都会被打印出来，生产环境建议配置到info.<br>Debug日志等级会包含大量调试日志，对性能有影响，一般在日常测试启用，生产环境切勿启用。</li></ul><hr><blockquote><p>Syntax: <strong>xquic_congestion_control</strong> <code>bbr</code>;<br>Default: <code>cubic</code><br>Context: <code>http</code></p></blockquote><p>配置xquic使用的congestion control算法，当前支持的算法类型有:</p><ul><li>reno</li><li>cubic</li><li>bbr<br>BBR当前对应的是BBR v1，默认值为cubic（与TCP默认congestion control算法对齐）。</li></ul><hr><blockquote><p>Syntax: <strong>xquic_socket_rcvbuf</strong> <code>5242880</code>;<br>Default: <code>1048576</code><br>Context: <code>http</code></p></blockquote><p>xquic使用socket rcvbuf大小设置，默认是1M大小，配置后会使用socket option设置到内核。</p><hr><blockquote><p>Syntax: <strong>xquic_socket_sndbuf</strong> <code>5242880</code>;<br>Default: <code>1048576</code><br>Context: <code>http</code></p></blockquote><p>xquic使用socket rcvbuf大小设置，默认是1M大小，配置后会使用socket option设置到内核。</p><hr><blockquote><p>Syntax: <strong>xquic_anti_amplification_limit</strong> <code>5</code>;<br>Default: <code>5</code><br>Context: <code>http</code></p></blockquote><p>xquic在握手期间限制的反射放大倍数，这个参数用于在握手未完成地址校验前，限制服务端返回的数据量倍数N（即服务端返回的数据量 &lt;= 收到客户端发送的数据量 * N）。<br>这个参数在RFC草案中的建议是不超过3倍，由于考虑到实际握手返回的证书大小，一般最大设置为5倍（从安全性角度不建议更大）。</p></div></div></article></div></div></section></div><div class="container-fluid global-footer"><div class="row"><div class="container"><div class="row"><div class="col-lg-6 col-xs-6"><div class="footer-logo"></div></div><div class="col-lg-6 col-xs-6 clearfix"><select class="lang-switch pull-right"></select></div><div class="col-lg-12 col-lg-offset-0 col-xs-offset-1 col-xs-10"><span class="footer-text copyright">&copy; 2011-2023 <a href="https://www.alibabagroup.com/" target="_blank">Alibaba Group</a>. All rights reserved.</span> <span class="footer-text design-by">Designed by Aliyun UED AX, Proudly powered by <a href="https://github.com/alibaba/tengine-ingress" target="_blank">Tengine-Ingress</a> on <a href="https://www.aliyun.com/" target="_blank">Aliyun</a>.</span></div></div></div></div></div><script src="/js/base.min.js"></script><script src="/js/app.min.js"></script></body></html>