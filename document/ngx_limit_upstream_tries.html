<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The Tengine Web Server</title>
  <link rel="stylesheet" type="text/css" href="../style.css">
  <script type="text/javascript" src="/js/??ga.js,correctpng.js?v=1"></script>
</head>

<body>
<div id="container">
  <div id="menu">
    <ul>
      <li><a href="../download.html"><img src="../images/icon-down.png"/>Download</a></li>
      <li><a href="../source.html"><img src="../images/icon_code.png"/>Source</a></li>
      <li><a href="../documentation.html"><img src="../images/icon-doc.png"/>Documentation</a></li>
      <li><a href="../faq.html"><img src="../images/icon-faq.png"/>FAQ</a></li>
      <li><a href="../contact.html"><img src="../images/icon-contact.png"/>Contact</a></li>
	    <li id="lang"><a href="../index_cn.html">中文</a> | <a href="../index.html">English</a></li>
    </ul>
  </div>
  <div id="logo"><a href="../index.html"><img src="../images/logo.png" alt="tengine" /></a></div>
  <div class="clear"></div>
  <div class="one_col more_padding font16">


<p><strong>limit upstream retries</strong></p>

<p>Limits retries for upstream servers (proxy, memcached, fastcgi, scgi, uwsgi).
Using one of the directives below will enable this feature.</p>

<div class="dh">Example</div>

<pre class="mod_example"><code>http {
    upstream test {
        server 127.0.0.1:8081;
        server 127.0.0.2:8081;
        server 127.0.0.3:8081;
        server 127.0.0.4:8081;
    }

    server {
        proxy_upstream_tries 2;
        proxy_set_header Host $host;

        location / {
            proxy_pass test;
        }
    }
}
</code></pre>

<div class="dh">Directives</div>

<br /><br />

<div class="directive"><p>Syntax: <strong>fastcgi_upstream_tries</strong> num</p>

<p>Default: -</p>

<p>Context: http, server, locatioon</p></div>

<p>Limit the maximum number of tries for fastcgi proxy. Nginx tries to connect different server each time.</p>

<br /><br />

<div class="directive"><p>Syntax: <strong>proxy_upstream_tries</strong> num</p>

<p>Default: -</p>

<p>Context: http, server, locatioon</p></div>

<p>Limit the maximum number of tries for http proxy. Nginx tries to connect different server each time.</p>

<br /><br />

<div class="directive"><p>Syntax: <strong>memcached_upstream_tries</strong> num</p>

<p>Default: -</p>

<p>Context: http, server, locatioon</p></div>

<p>Limit the maximum number of tries for memcached proxy. Nginx tries to connect different server each time.</p>

<br /><br />

<div class="directive"><p>Syntax: <strong>scgi_upstream_tries</strong> num</p>

<p>Default: -</p>

<p>Context: http, server, locatioon</p></div>

<p>Limit the maximum number of tries for scgi proxy. Nginx tries to connect different server each time.</p>

<br /><br />

<div class="directive"><p>Syntax: <strong>uwsgi_upstream_tries</strong> num</p>

<p>Default: -</p>

<p>Context: http, server, locatioon</p></div>

<p>Limit the maximum number of tries for uwsgi proxy. Nginx tries to connect different server each time.</p>
  </div>
</div>
<div id="copyright">&copy; 2011-2014 Taobao Inc. All rights reserved.</div>
</body>
</html>
