<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The Tengine Web Server</title>
  <link rel="stylesheet" type="text/css" href="../style.css">
  <script type="text/javascript" src="/js/??ga.js,correctpng.js?v=1"></script>
</head>

<body>
<div id="container">
  <div id="menu">
    <ul>
      <li><a href="../download_cn.html"><img src="../images/icon-down.png"/>下载</a></li>
      <li><a href="../source_cn.html"><img src="../images/icon_code.png"/>源码</a></li>
      <li><a href="../documentation_cn.html"><img src="../images/icon-doc.png"/>文档</a></li>
      <li><a href="../faq_cn.html"><img src="../images/icon-faq.png"/>FAQ</a></li>
      <li><a href="../contact_cn.html"><img src="../images/icon-contact.png"/>联系我们</a></li>
      <li id="book"><a href="../book/">开发教程</a></li>
      <li id="lang"><a href="../index_cn.html">中文</a> | <a href="../index.html">English</a></li>
    </ul>
  </div>
  <div id="logo"><a href="../index_cn.html"><img src="../images/logo.png" alt="tengine" /></a></div>
  <div class="clear"></div>
  <div class="one_col more_padding font16">
    <div class="module">ngx_http_upstream_dynamic_module</div>
    <div class="mod_intro"><p>此模块提供了在运行时动态解析upstream中server域名的功能。
<pre class="mod_example">
    upstream backend {
        dynamic_resolve fallback=stale fail_timeout=30s;

        server a.com;
        server b.com;
    }

    server {
        ...

        location / {
            proxy_pass http://backend;
        }
    }
</pre>
</p>
    </div>
    <div class="dh">指令</div>
    <div class="directive">
Syntax: <b>dynamic_resolve</b> [fallback=stale|next|shutdown] [fail_timeout=time]<br/>
Default: -<br/>
Context: upstream.
    </div>
    <div class="introduce"><p>指定在某个upstream中启用动态域名解析功能。<p/>
        fallback参数指定了当域名无法解析时采取的动作：
        <ul>
            <li> stale, 使用tengine启动的时候获取的旧地址
            <li> next, 选择upstream中的下一个server
            <li> shutdown, 结束当前请求
        </ul>
        <p/>
        fail_timeout参数指定了将DNS服务当做无法使用的时间，也就是当某次DNS请求失败后，假定后续多长的时间内DNS服务依然不可用，以减少对无效DNS的查询。
    </p></div>
  </div>
</div>
<div id="copyright">&copy; 2011-2014 Taobao Inc. All rights reserved.</div>
</body>
</html>
